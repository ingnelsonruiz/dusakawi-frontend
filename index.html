<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dusakawi - Test de Conexión</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 flex items-center justify-center h-screen">

    <div class="bg-white p-10 rounded-[3rem] shadow-xl border border-slate-200 text-center max-w-md">
        <h1 class="text-xl font-black text-slate-800 mb-4">Estado del Backend</h1>
        
        <div id="luz" class="w-12 h-12 rounded-full bg-slate-300 mx-auto mb-6 border-4 border-white shadow-inner"></div>
        
        <p id="info" class="text-slate-500 text-sm font-medium mb-6">Conectando con api-ejecutor-python.onrender.com...</p>
        
        <button onclick="probar()" class="bg-blue-600 text-white px-8 py-3 rounded-2xl font-black hover:bg-blue-700 transition-all shadow-lg shadow-blue-100">
            REINTENTAR
        </button>

        <div id="debug" class="mt-6 text-[10px] text-left bg-slate-50 p-4 rounded-xl font-mono text-slate-400 hidden"></div>
    </div>

    <script>
        const API_URL = "https://api-ejecutor-python.onrender.com";

        async function probar() {
            const luz = document.getElementById('luz');
            const info = document.getElementById('info');
            const debug = document.getElementById('debug');
            
            luz.className = "w-12 h-12 rounded-full bg-yellow-400 mx-auto mb-6 animate-pulse";
            info.innerText = "Esperando respuesta de Render...";

            try {
                // Probamos la ruta de salud que definimos en Python
                const res = await fetch(`${API_URL}/health`);
                
                if (res.ok) {
                    const data = await res.json();
                    luz.className = "w-12 h-12 rounded-full bg-green-500 mx-auto mb-6 shadow-[0_0_15px_rgba(34,197,94,0.5)]";
                    info.innerHTML = "<span class='text-green-600 font-bold text-lg'>¡CONECTADO!</span><br>El servidor está encendido.";
                    debug.classList.remove('hidden');
                    debug.innerText = "Respuesta: " + JSON.stringify(data);
                } else {
                    throw new Error("El servidor respondió con error " + res.status);
                }
            } catch (err) {
                luz.className = "w-12 h-12 rounded-full bg-red-500 mx-auto mb-6 shadow-[0_0_15px_rgba(239,68,68,0.5)]";
                info.innerHTML = "<span class='text-red-600 font-bold text-lg'>SIN CONEXIÓN</span><br>El servidor no responde.";
                debug.classList.remove('hidden');
                debug.innerText = "Error: " + err.message + "\n\nPosibles causas:\n1. El servidor sigue cargando.\n2. Falta configurar CORS en Python.";
            }
        }

        // Ejecutar al abrir la página
        probar();
    </script>
</body>
</html>
